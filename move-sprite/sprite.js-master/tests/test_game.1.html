<!DOCTYPE html><html>
<head>
<title>Test game like</title>
<meta name = "viewport" content = "user-scalable=no, width=device-width">
</head>
<body>


</body>
<script src="../vendors/touch.js"></script>
<script src="../sprite.js"></script>
<script src="../lib/collision.js"></script>
<script>

window.onload = function() {
    var game_height = 500;
    var game_width = 200;
    var scene = sjs.Scene({w:game_width, h:game_height});
    var layer = scene.Layer('front');
    var player = layer.Sprite('img/character.png');
    var plateforms = [];

    player.move(20, 390);
    player.size(23, 51);

    var input  = scene.Input();

    var cycle = scene.Cycle([[3, 3, 1],
                               [33, 3, 1],
                               [63, 3, 2],
                               [93, 3, 2],
                               [123, 3, 2],
                               [153, 3, 2],
                               [183, 3, 2]]);
    cycle.addSprite(player);

    var xVelocity = 0, yVelocity = 0;

    function animation() {
        var x = player.x + player.w;
        var y = player.y + player.h;
        var hasWallContact = y > window.innerHeight;

        if(!hasWallContact) {
            for(var i=0; i < plateforms.length; i++) {
                hasWallContact = plateforms.isPointIn(x, y);
            }
        }

        if(!input.keyboard.left && !input.keyboard.right)
            xVelocity = xVelocity / 2;

        if(input.keyboard.left) {
            xVelocity = Math.max(-3.5, xVelocity-1);
            player.scale(1, 1);
        }
        if(input.keyboard.right) {
            xVelocity = Math.min(3.5, xVelocity+1);
            player.scale(-1, 1);
        }

        player.move(xVelocity, yVelocity);
        if(player.x < 0)
            player.setX(0);
        if(player.x > game_width - 20)
            player.setX(game_width - 20);
  
        player.update();
        if(input.arrows())
            cycle.next(ticker.lastTicksElapsed);
        else
            cycle.reset();
    };

    var ticker = scene.Ticker(25, animation);
    ticker.run();

};
</script>
</html>
